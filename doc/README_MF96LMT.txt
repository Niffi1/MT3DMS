README FILE FOR MODFLOW-96 WITH LINK-MT3D INTERFACE
Chunmiao Zheng (czheng@ua.edu)
Last revision: 05-25-2003
----------------TABLE OF CONTENTS
----------------GENERAL INFORMATION
IMPLEMENTING THE LINK-MT3D PACKAGE
USING THE LINK-MT3D PACKAGE
A NOTE ON THE UNFORMATTED FLOW-TRANSPORT LINK FILE
SYSTEM REQUIREMENTS AND DYNAMIC MEMORY ALLOCATION
INSTALLATION AND RECOMPILING
ADD-ON PACKAGES
LIST OF FILES
GENERAL INFORMATION
------------------This ReadMe file documents a modified version of MODFLOW-96 with the Link-MT3D
(LMT) Package Version 5.0. The original files for MODFLOW-96 were dated May
2000 and downloaded from the USGS ground-water software web site
http://water.usgs.gov/nrp/gwsoftware/. For more information on the standard USGS
version of MODFLOW-96, refer to the ReadMe file MODFLW96.TXT.
The version of MODFLOW-96 included with MT3DMS is identical to the standard USGS
version as downloaded except for the following additions:
1) the LMT package for saving the flow-transport like file needed by the
MT3D/MT3DMS series of transport codes;
2) dynamic memory allocation;
3) printing of iterative solver statistics to the computer screen.
IMPLEMENTING THE LINK-MT3D PACKAGE
---------------------------------The version of MODFLOW-96 distributed with MT3DMS has already included the LinkMT3D package. If you are interested in implementing the LMT package on your own
version of MODFLOW-96, follow the procedures described below:
1) Assign the character string 'LMT' to the 22nd element of the CUNIT array by
modifying the DATA statement in the MODFLOW-96 main program as follows:
C...beginning of DATA statement
DATA CUNIT/'BCF ','WEL ','DRN
1
'RCH ','SIP ','DE4
2
'
','HFB ','RES
3
'LMT ','
','
4
'
','
','
5
'
','
','
C...end of DATA statement

','RIV
','SOR
','STR
','
','
','

1

','EVT
','OC
','IBS
','
','
','

','TLK
','PCG
','CHD
','
','
'/

','GHB
','GFD
','FHB
','
','

',
',
',
',
',

2) Add an INCLUDE statement to the main program immediately before the
'CALL BAS5OT(...)' statement as follows:
C...added...beginning...
C-----SAVE INFORMATION FOR USE BY THE MT3D SOLUTE TRANSPORT MODEL
INCLUDE 'M96LKMT5.INC'
C...added...end...
C
C-----PRINT AND OR SAVE HEADS AND DRAWDOWNS. PRINT OVERALL BUDGET.
CALL BAS5OT(X(LCHNEW),X(LCSTRT),ISTRT,X(LCBUFF),X(LCIOFL),
and
3) Recompile the MODFLOW-96 source files with the include file 'M96LKMT5.INC'
and a second source file 'M96LKMT5.FOR'. Make sure that these two files are
in the same working directory with all other MODFLOW-96 source files.
USING THE LINK-MT3D PACKAGE
--------------------------To activate the LMT Package 5.0 to save the flow-transport file needed by
MT3D/MT3DMS, insert a line (shown in capital letters) into the MODFLOW-96 NAME
file as in the following example.
An example of MODFLOW-96 NAME file:
list 6 test1.lst
bas
1 test1.bas
bcf 11 test1.bcf
sip 13 test1.sip
oc
14 test1.oc
LMT 32 TEST1.FTL
data(binary) 93 test1.ufh
where LMT is the name of the Link-MT3D package, integer 32 is the FORTRAN
unit on which the flow-transport link file will be saved, and TEST1.FTL is
the name of the flow-transport link file containing the flow model information
needed by MT3D/MT3DMS. The unit for LMT can be any positive integer as long as
it has not been used for any other files. Any valid file name can be specified
by the user for the flow-transport link file. When running MT3D/MT3DMS and
prompted for the name of the flow-transport link file, make sure to enter the
same file name, e.g., TEST1.FTL in this example.
A NOTE ON THE UNFORMATTED FLOW-TRANSPORT LINK FILE
-------------------------------------------------Note that the flow-transport link file saved by the LMT Package 5.0 is
unformatted (binary characters). Different FORTRAN compilers or even different
versions of the same compiler may use different file structures and styles for
the unformatted binary files. For this reason, the MT3D/MT3DMS code compiled by
a particular compiler may not be able to read the unformatted flow-transport
link file saved by a MODFLOW code that was compiled with a different compiler or
compiler version, and vice versa.
This version of MODFLOW-96 was compiled by Lahey Fortran 95 compiler (LF95). The
style of unformatted files generated by LF95-compiled programs is compatible

2

with that of Visual Fortran (VF) from Compaq/HP, but not compatible with that of
Lahey Fortran 90 compiler (LF90) used for compiling MT3D/MT3DMS prior to Version
4.5. Thus, it may be necessary to re-run an existing flow model using this
version of MODFLOW-96 to create the flow-transport link file for use by MT3DMS
4.5. Also, several utility programs included with the MT3DMS 4.5 distribution
files may be used to convert an unformatted flow-transport link file from the
LF90-style to LF95/VF-style, and vice versa. For more information, refer to the
ReadMe file for MT3DMS 4.5 utilities (Utilities.PDF).
SYSTEM REQUIREMENTS AND DYNAMIC MEMORY ALLOCATION
------------------------------------------------The executable program, mf96.exe, was compiled with the Lahey FORTRAN 95
compiler LF95 Version 5.70 to run on PCs equipped with Pentium or higher CPUs
under various versions of the Microsoft Windows operating system. The executable
program was compiled with dynamic memory allocation and will allocate the exact
amount of memory that is required for a particular problem at run-time. If the
memory required by the problem exceeds the total amount of physical memory that
is available, mf96.exe will print out a message "NOT ENOUGH MEMORY" and then
aborts. mf96.exe is a console mode application under Microsoft Windows
9x/2000/NT/XP.
INSTALLATION AND RECOMPILING
---------------------------The executable code for this version of MODFLOW-96 has been included as part of
the MT3DMS 4.5 distribution files. If the source code is recompiled, copy the
recompiled executable file to the subdirectory where the MT3D/MT3DMS executable
files are located.
To use the MODFLOW-96 program independently, create a subdirectory with a name
such as ‘MF96LMT\bin’ and copy the file ‘mf96.exe’ to the new subdirectory. To
make the MODFLOW-96 program accessible from any directory, the subdirectory
containing the executable should be included in the PATH environment variable.
For example, a line similar to the following can be added to the AUTOEXEC.BAT or
AUTOEXEC.NT file:
PATH=%PATH%;C:\MF96LMT\bin
Make sure to substitute the appropriate drive letter and pathname if not C:\ as
shown above. Reboot the computer after modifying AUTOEXEC.BAT.
On Windows 9x/2000/NT/XP operating systems, from the Start menu, find and select
Control Panel. Then edit the PATH Environment Variable to include
“C:\MF96LMT\bin". Initiate and use a new MS-DOS Command Prompt window after
making this change.
To re-compile this version MODFLOW-96 with Lahey LF95, copy all source files to
a temporary subdirectory and type 'AM' to start the AUTOMAKE utility. The
compiler options that should be used for recompiling are contained in the file
Automake.fig.

3

ADD-ON PACKAGES
--------------This version of MODFLOW-96 contains the following add-on packages
Package
NAME

CUNIT/IUNUT
Position

TLK
DE4
PCG
GFD
HFB
RES
STR
IBS
CHD
FHB
LMT

6
10
15
14
16
17
18
19
20
21
22

Supported
by MT3D
No
n/a
n/a
No
Yes
No
Yes
No
Yes
No
Link-MT3D Interface

To use any of these packages, insert a corresponding line
in the MODFLOW NAME file in the form of
Ftype

Nunit

Fname

where Ftype is the predefined name of the Package;
Nunit is the FORTRAN unit to be used when reading from or writing to the file;
and Fname is the name of the file. For example, to use the PCG package,
enter a line such as
PCG

13

Test1.PCG

where Test1.PCG is the name of the input file for the PCG package.
LIST OF FILES
------------This version is distributed with the following files:
README_MF96LMT.txt:
MODFLW96.txt:
MF96_User_Guide.PDF:
MF96_Programmer_Guide.PDF:
mf96.exe:
m96lkmt5.for:
m96lkmt5.inc:
modflw96.for:
bas5.for:
bcf5.for:
drn5.for:
evt5.for:
rch5.for:
riv5.for:
sip5.for:

latest readme file (this file)
original readme file included with the USGS version
MODFLOW-96 User’s Guide
MODFLOW-96 Programmer’s Guide

executable program for PCs with Pentium or higher CPUs
source file for LinK-MT3D package (for linking with MT3DM
source "include file" used by MAIN to invoke Link-MT3D package
source file for MAIN program
source file for Basic package
source file for Block-Centered Flow package
source file for Drain package
source file for Evapotranspiration package
source file for Recharge package
source file for River package
source file for Strongly Implicit Procedure package

4

sor5.for:
wel5.for:
ghb5.for:
utl5.for:
pcg2.for:
str1.for:
gfd1.for:
hfb1.for:
ibs1.for:
chd1.for:
tlk1.for:
de45.for:
res1.for:
fhb1.for:
automake.fig:

source file for Slice Successive Over-Relaxation package
source file for Well package
source file for General Head Boundary package
source file for Utility package
source file for Preconditioned Conjugate Gradient Package
source file for Stream Package
source file for General Finite Difference Flow Package
source file for Horizontal Flow Barrier Package
source file for Interbed-Storage Package
source file for Time-Variant Specified-Head Package
source file for Transient Leakage Package
source file for Direct solver
source file for Reservoir Package
source file for Flow and Head Boundary package
lf95 configuration for the Automake utility

5

